@page "/jt19056analyze"

@using JT808.Protocol;
@using JT808.Protocol.Extensions;
@using Newtonsoft.Json;
@inject IJT808Config  Config

<h3>jt808analyze</h3>

<p>Up Hex: @UpHexData</p>
<p>Down Hex: @DownHexData</p>

<button class="btn btn-primary" @onclick="UpQuery">上行分析</button>
<button class="btn btn-primary" @onclick="DownQuery">下行分析</button>

<div class="right">
    @UpJson
    <br />
    @DownJson
</div>

@code {
    private JT808CarDVRSerializer Serializer;

    private string UpHexData = "7E 02 00 00 26 12 34 56 78 90 12 00 7D 02 00 00 00 01 00 00 00 02 00 BA 7F 0E 07 E4 F1 1C 00 28 00 3C 00 00 18 10 15 10 10 10 01 04 00 00 00 64 02 02 00 7D 01 13 7E";
    private string DownHexData = "7E 02 00 00 26 12 34 56 78 90 12 00 7D 02 00 00 00 01 00 00 00 02 00 BA 7F 0E 07 E4 F1 1C 00 28 00 3C 00 00 18 10 15 10 10 10 01 04 00 00 00 64 02 02 00 7D 01 13 7E";

    private string UpJson;
    private string DownJson;

    protected override void OnInitialized()
    {
        Serializer = Config.GetCarDVRSerializer();
    }

    private void UpQuery()
    {
        var data = UpHexData.ToHexBytes();
        UpJson = Serializer.UpAnalyze(data);
    }

    private void DownQuery()
    {
        var data = DownHexData.ToHexBytes();
        DownJson = Serializer.UpAnalyze(data);
    }

}
